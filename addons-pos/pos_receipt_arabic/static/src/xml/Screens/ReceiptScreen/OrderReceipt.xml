<?xml version="1.0" encoding="utf-8"?>
<templates id="template" xml:space="preserve">

    <t t-name="OrderReceipt" t-inherit="point_of_sale.OrderReceipt" t-inherit-mode="extension" owl="1">
        <xpath expr="//div[hasclass('pos-receipt')]" position="replace">
        <div class="pos-receipt">

            <t t-if="receipt.company.logo"><img class="pos-receipt-logo" t-att-src="receipt.company.logo" alt="Logo"/><br/></t>

            <t t-if="!receipt.company.logo">
                <h2 class="pos-receipt-center-align">
                    <t t-esc="receipt.company.name" /><br/>
                    <t t-esc="receipt.company.arabic_name" />
                </h2><br/>
            </t>

            <div class="pos-receipt-contact">

                <t t-if="receipt.company.logo">
                    <div style="font-size:20px">
                        <t t-esc="receipt.company.name"/><br/>
                        <t t-esc="receipt.company.arabic_name"/>
                    </div>
                </t>

                <t t-if="receipt.company.phone"><div>Tel:<t t-esc="receipt.company.phone" /></div></t>
                <t t-if="receipt.company.vat"><div><t t-esc="receipt.company.vat_label"/>:<t t-esc="receipt.company.vat" /></div></t>
                <t t-if="receipt.company.email"><div><t t-esc="receipt.company.email" /></div></t>
                <t t-if="receipt.company.website"><div><t t-esc="receipt.company.website" /></div></t>
                <t t-if="receipt.header_html"><t t-raw="receipt.header_html" /></t>
                <t t-if="!receipt.header_html and receipt.header"><div><t t-esc="receipt.header" /></div></t>
                <t t-if="receipt.cashier"><div class="cashier"><div>--------------------------------</div><div>Served by <t t-esc="receipt.cashier" /></div></div></t>

            </div>
            <br />

            <div style="font-size:70%;">
                <table style="width:100%">
                    <tr>
                        <td style="text-align:left">Invoice Number</td>
<!--                        <td style="text-align:center"><t t-esc="receipt.name_compressed" /></td>-->
                        <td style="text-align:center"><t t-esc="receipt.name" /></td>
                        <td style="text-align:right">رقم الفاتورة</td>
                    </tr>
                    <tr>
                        <td style="text-align:left">Invoice Issue Date</td>
                        <td style="text-align:center"><t t-esc="receipt.date.localestring or order.validation_date" /></td>
                        <td style="text-align:right">تاریخ اصدار الفاتورة</td>
                    </tr>

                </table>
            </div>
            <br />


            <!-- Orderlines -->

<!--            <div class="orderlines">-->
<!--                <t t-foreach="receipt.orderlines" t-as="line" t-key="line.id">-->
<!--                    <t t-if="isSimple(line)">-->
<!--                        <div>-->
<!--                            <t t-esc="line.product_name_wrapped[0]" />-->
<!--                            <span t-esc="env.pos.format_currency_no_symbol(line.price_display)" class="price_display pos-receipt-right-align"/>-->
<!--                        </div>-->
<!--                        <WrappedProductNameLines line="line" />-->
<!--                    </t>-->
<!--                    <t t-else="">-->
<!--                        <div t-esc="line.product_name_wrapped[0]" />-->
<!--                        <WrappedProductNameLines line="line" />-->
<!--                        <t t-if="line.display_discount_policy == 'without_discount' and line.price != line.price_lst">-->
<!--                            <div class="pos-receipt-left-padding">-->
<!--                                <t t-esc="env.pos.format_currency_no_symbol(line.price_lst)" />-->
<!--                                ->-->
<!--                                <t t-esc="env.pos.format_currency_no_symbol(line.price)" />-->
<!--                            </div>-->
<!--                        </t>-->
<!--                        <t t-elif="line.discount !== 0">-->
<!--                            <div class="pos-receipt-left-padding">-->
<!--                                <t t-if="env.pos.config.iface_tax_included === 'total'">-->
<!--                                    <t t-esc="env.pos.format_currency_no_symbol(line.price_with_tax_before_discount)"/>-->
<!--                                </t>-->
<!--                                <t t-else="">-->
<!--                                    <t t-esc="env.pos.format_currency_no_symbol(line.price)"/>-->
<!--                                </t>-->
<!--                            </div>-->
<!--                        </t>-->
<!--                        <t t-if="line.discount !== 0">-->
<!--                            <div class="pos-receipt-left-padding">-->
<!--                                Discount: <t t-esc="line.discount" />%-->
<!--                            </div>-->
<!--                        </t>-->
<!--                        <div class="pos-receipt-left-padding">-->
<!--                            <t t-esc="Math.round(line.quantity * Math.pow(10, env.pos.dp['Product Unit of Measure'])) / Math.pow(10, env.pos.dp['Product Unit of Measure'])"/>-->
<!--                            <t t-if="line.unit_name !== 'Units'" t-esc="line.unit_name" />-->
<!--                            x-->
<!--                            <t t-esc="env.pos.format_currency_no_symbol(line.price_display_one)" />-->
<!--                            <span class="price_display pos-receipt-right-align">-->
<!--                                <t t-esc="env.pos.format_currency_no_symbol(line.price_display)" />-->
<!--                            </span>-->
<!--                        </div>-->
<!--                    </t>-->
<!--                </t>-->
<!--            </div>-->

            <div class="pos-receipt-line-table">
                <table style="width: 100%">
                    <tr style="font-size:14px">
                        <th width="50%">
                            Products <br />
                            منتجات
                        </th>
                        <th width="18%">
                            Unit price <br />
                            سعر الوحدة
                        </th>
                        <th width="15%">
                            Quantity <br />
                            الكمیة
                        </th>
                        <th width="17%">
                            Subtotal <br />
                            المجموع
                        </th>
                    </tr>
                    <t t-foreach="receipt.orderlines" t-as="line" t-key="line.id">
                    <tr style="font-size:12px">
                        <td>
                            <t t-esc="line.product_name" /> <br />
                            <t t-esc="line.product_arabic_name" />
                            <t t-esc="line.product_name" />
                        </td>
                        <td class="pos-receipt-right-align">
                            <t t-esc="env.pos.format_currency(line.price)" />
                        </td>
                        <td>
                            <t t-esc="line.quantity" /> <t t-esc="line.unit_name" />
                        </td>
                        <td class="pos-receipt-right-align">
                            <t t-esc="env.pos.format_currency(line.price_with_tax)" />
                        </td>
                    </tr>
                    </t>
                    <tr>
                        <td colspan="4"><hr /></td>
                    </tr>
                    <tr t-if="receipt.total_discount > 0.0">
                        <td colspan="3">
                            Discount
                            خصم
                        </td>
                        <td class="pos-receipt-right-align">
                            <t t-esc="env.pos.format_currency(receipt.total_discount)" />
                        </td>
                    </tr>
                    <tr t-if="receipt.total_rounded != receipt.total_with_tax">
                        <td colspan="3">
                            Rounding
                            التقريب
                        </td>
                        <td class="pos-receipt-right-align">
                            <t t-esc="env.pos.format_currency(receipt.rounding_applied)" />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3">
                            Total (Excluding VAT)
                            حاصل الجمع
                        </td>
                        <td class="pos-receipt-right-align">
                            <t t-esc="env.pos.format_currency(receipt.total_without_tax)" />
                        </td>
                    </tr>

                    <t t-foreach="receipt.tax_details" t-as="tax" t-key="tax.name">
                        <tr>
                            <td colspan="3">
                                Total VAT
                                (<t t-esc="receipt.tax_details[0].tax.amount" /> %)
                                <span>مجموع ضریبة</span>
                            </td>
                            <td><span t-esc='env.pos.format_currency_no_symbol(tax.amount)' class="pos-receipt-right-align"/>
                            </td>
                        </tr>

                     </t>


                    <tr>
                        <td colspan="3">
                            Total Amount
                            إجمالي
                        </td>
                        <td class="pos-receipt-right-align">
                            <t t-esc="env.pos.format_currency(receipt.total_rounded)" />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="4"><hr /></td>
                    </tr>
                </table>
                </div>

             <div class="pos-center-align">
                 <div><t t-esc="receipt.name" /></div>
                    <div t-attf-id="qrcode_container">
                        <div id="qrcodeimage"></div>
                            <div t-if="receipt.qr_code" id="qrcode" class="pos-receipt-logo"/>
                    </div>
                </div>

<!--             <div class="pos-center-align">-->
<!--                    <div t-attf-id="qrcode_container">-->
<!--                        <div id="qrcodeimage"></div>-->
<!--                        <script type="text/javascript">-->

<!--                            var qr_data = "<t t-esc="receipt.qr_data" />";-->
<!--                            var qrcode = new QRCode("qrcodeimage" , {-->
<!--                                text: qr_data,-->
<!--                                width: 180,-->
<!--                                height: 180,-->
<!--                                colorDark : "#000000",-->
<!--                                colorLight : "#ffffff",-->
<!--                                correctLevel : QRCode.CorrectLevel.H-->
<!--                            });-->
<!--                            qrcode.makeCode(qr_data);-->

<!--                            $("#qrcodeimage > img").css({"margin":"20px auto"});-->
<!--                        </script>-->
<!--                    </div>-->
<!--                </div>-->



            <div class="before-footer" />

            <!-- Footer -->
            <div t-if="receipt.footer_html"  class="pos-receipt-center-align">
                <t t-raw="receipt.footer_html" />
            </div>

            <div t-if="!receipt.footer_html and receipt.footer"  class="pos-receipt-center-align" style="white-space:pre-line">
                <br/>
                <t t-esc="receipt.footer" />
                <br/>
                <br/>
            </div>

            <div class="after-footer">
                <t t-foreach="receipt.paymentlines" t-as="line">
                    <t t-if="line.ticket">
                        <br />
                        <div class="pos-payment-terminal-receipt">
                            <t t-raw="line.ticket" />
                        </div>
                    </t>
                </t>
            </div>

            <br/>
            <div class="pos-receipt-order-data">
                <div><t t-esc="receipt.name" /></div>
                <div><t t-esc="receipt.date.localestring" /></div>
            </div>

        </div>


        </xpath>

    </t>

</templates>
